pipeline {
  agent any
  tools {
    maven 'M2_HOME'
        }
stages {
  stage('git checkout') {
  steps {
   git 'https://github.com/jahnavimandarapu/test.git'
  }
}
stage('build package'){
    steps {
      sh 'mvn package'
    }
  }
stage('building docker image'){
    steps {
      sh 'docker build -t mandarapujahnavi/springbootnew:2.0 .'
    }
            }
stage ('docker image push'){
    steps {
      withCredentials([string(credentialsId: 'dockerhubpwd', variable: 'hub2docker')]) {
      sh 'docker login -u mandarapujahnavi -p ${hub2docker}'
      }
      sh 'docker push mandarapujahnavi/springbootnew:2.0'   
    }
  }
stage ('application deployment as container'){
   steps {
    ansiblePlaybook become: true, credentialsId: '8d8f9754-784c-4917-9c57-e001bc07d969', disableHostKeyChecking: true, installation: 'ansible', inventory: 'prod.inv', playbook: 'deploy.yml', vaultTmpPath: ''
   }
  }
}
        }
